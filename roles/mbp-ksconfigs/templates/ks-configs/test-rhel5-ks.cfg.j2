# Kickstart file automatically generated by anaconda.

install
#url --url {{linux_install_server_url}}/rhel/5/x86_64
cdrom
key --skip
lang en_US.UTF-8
keyboard us
#xconfig --startxonboot
reboot
# Network information
network  --bootproto=static --device=eth0 --gateway={{nat_gateway}} --ip={{nat_short_net}}.33 --nameserver={{dns_servers|join(",")}} --netmask={{nat_netmask}} --hostname=test-rhel5.{{domain_name}} #--noipv6

user --groups=wheel --name=chris --uid=1000 --password=$6$Cn2vwW.vUq0qFXYG$P6ogDQM8pvhpGk/InzJ4Lh9eiO/lnsJiF6rb3jYAKA4jreq5hGCXg2Gu.v6zIW1bNeSCLix0k0Pq2MXn8OLAu/ --iscrypted #--gecos="Chris Tjon"

rootpw --iscrypted $1$IUC2GlW9$Od.EiQTGl21qcO3zyA9uZ1
firewall --enabled --port=22:tcp
authconfig --enableshadow --enablemd5
selinux --disabled
timezone --utc America/Phoenix
bootloader --location=mbr --driveorder=sda --append="rhgb quiet"
# The following is the partition information you requested
# Note that any partitions you deleted are not expressed
# here so unless you clear all partitions first, this is
# not guaranteed to work
clearpart --drives=sda --all
zerombr
part /boot --fstype ext3 --size=256
part pv.2 --size=0 --grow --ondisk=sda
volgroup rootvg --pesize=32768 pv.2
logvol /var --fstype ext3 --name=varlv --vgname=rootvg --size=1024
logvol /opt --fstype ext3 --name=optlv --vgname=rootvg --size=32
logvol / --fstype ext3 --name=rootlv --vgname=rootvg --size=512
logvol /usr --fstype ext3 --name=usrlv --vgname=rootvg --size=4096
logvol swap --fstype swap --name=swaplv --vgname=rootvg --size=2048
logvol /home --fstype ext3 --name=homelv --vgname=rootvg --size=512
logvol /tmp --fstype ext3 --name=tmplv --vgname=rootvg --size=1024

%packages
@admin-tools
@base
@core
@dialup
@editors
@gnome-desktop
@games
@graphical-internet
@graphics
@java
@legacy-software-support
@office
@printing
@sound-and-video
@text-internet
@base-x
kexec-tools
iscsi-initiator-utils
fipscheck
device-mapper-multipath
sgpio
emacs
libsane-hpaio
xorg-x11-utils
xorg-x11-server-Xnest

%post
# install bash_profile for root
curl  {{config_files_url}}/bash_profile >> /root/.bash_profile
chmod 600 /root/.bash_profile
chown root:root /root/.bash_profile

# install bash_profile for chris
curl  {{config_files_url}}/bash_profile >> /home/chris/.bash_profile
chmod 600 /home/chris/.bash_profile
chown chris:chris /home/chris/.bash_profile

# install ssh key for chris
mkdir /home/chris/.ssh
chmod 700 /home/chris/.ssh
curl  {{config_files_url}}/chris-mbp-id_rsa.pub >> /home/chris/.ssh/authorized_keys
chmod 600 /home/chris/.ssh/authorized_keys
chown -R chris:chris /home/chris/.ssh
restorecon -RFv /home/chris/.ssh/authorized_keys

# configure sudoers file
curl {{config_files_url}}/sudoers-rhel5 -o /etc/sudoers
chown -R root:root /etc/sudoers
chmod 440 /etc/sudoers
restorecon -RFv /etc/sudoers

# Put Python 2.6 on RHEL5 from EPEL Archive to allow Ansible to work
#rpm --import {{linux_install_server_url}}/epel-archive/RPM-GPG-KEY-EPEL-5
#rpm -ivh {{linux_install_server_url}}/epel-archive/5Client/x86_64/{python26-2.6.8-2.el5.x86_64.rpm,libffi-3.0.5-1.el5.x86_64.rpm,python26-libs-2.6.8-2.el5.x86_64.rpm}

rpm --import http://archives.fedoraproject.org/pub/archive/epel/RPM-GPG-KEY-EPEL-5
rpm -ivh http://archives.fedoraproject.org/pub/archive/epel/5/x86_64/{python26-2.6.8-2.el5.x86_64.rpm,libffi-3.0.5-1.el5.x86_64.rpm,python26-libs-2.6.8-2.el5.x86_64.rpm}

%end
